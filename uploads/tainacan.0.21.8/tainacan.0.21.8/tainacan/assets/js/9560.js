"use strict";(self.webpackChunktainacan=self.webpackChunktainacan||[]).push([[9560],{15500:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(40834);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const c={name:"ImporterEditionForm",components:{MetadatumEditionForm:a(11158).A},data:function(){return{importerId:Number,importer:null,isLoading:!1,isLoadingSourceInfo:!1,isLoadingRun:!1,mappedCollection:{id:Number,mapping:{},total_items:Number},importerType:"",importerName:"",collection:void 0,importerSourceInfo:null,collections:[],collectionMetadata:[],collectionId:void 0,isNewMetadatumModalActive:!1,isLoadingMetadatumTypes:!1,selectedMetadatumType:void 0,isEditingMetadatum:!1,metadatum:{},backgroundProcess:void 0,metadataSearchCancel:void 0,showTitlePromptModal:!1,selectedTitle:void 0,formErrorMessage:""}},computed:l(l({},(0,n.L8)("metadata",{metadatumTypes:"getMetadatumTypes"})),{},{collectionNonChildMetadata:function(){var e=this;return Array.isArray(this.collectionMetadata)?this.collectionMetadata.filter((function(t){return!e.checkIfMetadatumIsChild(t)})):[]}}),created:function(){var e=this;this.importerType=this.$route.params.importerType,this.sessionId=this.$route.params.sessionId,this.collectionId=this.$route.params.collectionId,this.mappedCollection.id=this.collectionId,this.fetchAvailableImporters().then((function(t){t[e.importerType]&&(e.importerName=t[e.importerType].name)})),this.loadImporter(),this.fetchCollectionBasics({collectionId:this.collectionId,isContextEdit:!0}).then((function(t){e.collection=t}))},beforeUnmount:function(){null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled.")},methods:l(l(l(l(l({},(0,n.i0)("importer",["fetchAvailableImporters","fetchImporter","sendImporter","updateImporter","updateImporterFile","updateImporterURL","updateImporterOptions","fetchImporterSourceInfo","updateImporterCollection","runImporter","fetchMappingImporter"])),(0,n.i0)("bgprocess",["fetchProcess"])),(0,n.i0)("metadata",["fetchMetadata","fetchMetadatumTypes","sendMetadatum"])),(0,n.i0)("collection",["fetchCollectionBasics"])),{},{loadImporter:function(){var e=this;this.isLoading=!0,this.formErrorMessage="",this.fetchImporter(this.sessionId).then((function(t){e.sessionId=t.id,e.importer=JSON.parse(JSON.stringify(t)),e.isLoading=!1,e.isLoadingSourceInfo=!0,e.formErrorMessage="",e.fetchImporterSourceInfo(e.sessionId).then((function(t){e.importerSourceInfo=t,e.mappedCollection.total_items=e.importerSourceInfo.source_total_items,e.isLoadingSourceInfo=!1,e.loadMetadata()})).catch((function(t){e.isLoadingSourceInfo=!1,e.formErrorMessage=t.error_message,e.$console.log(t)}))})).catch((function(t){e.$console.error(t),e.formErrorMessage=t.error_message}))},loadMetadata:function(){var e=this;this.isFetchingCollectionMetadata=!0,null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled."),this.fetchMetadata({collectionId:this.collectionId,isRepositoryLevel:!1,isContextEdit:!1,parent:"any"}).then((function(t){e.formErrorMessage="",t.request.then((function(t){e.collectionMetadata=JSON.parse(JSON.stringify(t)),e.isFetchingCollectionMetadata=!1,e.fetchMappingImporter({collection:e.collectionId,sessionId:e.sessionId}).then((function(t){t&&(e.mappedCollection.mapping=t)}))})).catch((function(t){e.$console.error(t),e.formErrorMessage=t.error_message,e.isFetchingCollectionMetadata=!1})),e.metadataSearchCancel=t.source})).catch((function(){return e.isFetchingCollectionMetadata=!1}))},cancelBack:function(){this.$router.go(-2)},checkIfMetadatumIsAvailable:function(e){if(null!=this.mappedCollection.mapping[e]&&null!=this.importerSourceInfo&&null!=this.importerSourceInfo){var t=this.mappedCollection.mapping[e],a=this.importerSourceInfo.source_metadata;if(a&&a.indexOf(t)>=0)return!0}return!1},checkIfChildMetadatumIsAvailable:function(e,t,a){return!!(this.mappedCollection.mapping[t]&&this.mappedCollection.mapping[t][a]&&this.mappedCollection.mapping[t][a][e]&&null!=this.importerSourceInfo&&null!=this.importerSourceInfo)},checkIfMetadatumIsCompound:function(e){return e.metadata_type_object&&e.metadata_type_object.component&&"tainacan-compound"==e.metadata_type_object.component},checkCurrentSelectedCollectionMetadatum:function(e,t){for(var a in this.mappedCollection.mapping){if(this.mappedCollection.mapping[a]==e)return a;if(t&&Object.keys(this.mappedCollection.mapping[a])&&Object.keys(this.mappedCollection.mapping[a])[0]&&Object.keys(this.mappedCollection.mapping[a])[0]==e)return a}},checkCurrentSelectedCollectionChildMetadatum:function(e,t){if(this.mappedCollection.mapping[t]&&Object.values(this.mappedCollection.mapping[t])&&Object.values(this.mappedCollection.mapping[t])[0]){var a=Object.values(this.mappedCollection.mapping[t])[0];for(var n in a)if(a[n]==e)return n}else;},checkIfMetadatumIsChild:function(e){return e.parent&&e.parent>0},getChildOfSelectedCompoundMetadata:function(e){var t=this;return this.collectionMetadata.filter((function(a){return a.parent==t.checkCurrentSelectedCollectionMetadatum(Object.entries(e)[0][0],!0)}))},onRunImporter:function(e){var t=this;if(!0!==e){var a=this.collectionMetadata.findIndex((function(e){return"Tainacan\\Metadata_Types\\Core_Title"==e.metadata_type}));if(a>=0&&this.mappedCollection&&this.mappedCollection.mapping&&!this.mappedCollection.mapping[this.collectionMetadata[a].id])return void(this.showTitlePromptModal=!0)}this.isLoadingRun=!0,this.formErrorMessage="",this.updateImporterCollection({sessionId:this.sessionId,collection:this.mappedCollection}).then((function(e){t.importer=e,t.finishRunImporter()})).catch((function(e){t.isLoadingRun=!1,t.$console.log(e),t.formErrorMessage=e.error_message}))},finishRunImporter:function(){var e=this;this.formErrorMessage="",this.runImporter(this.sessionId).then((function(t){e.backgroundProcess=t,e.isLoadingRun=!1,e.$router.push(e.$routerHelper.getProcessesPage())})).catch((function(t){e.isLoadingRun=!1,e.$console.log(t),e.formErrorMessage=t.error_message}))},onSelectCollectionChildMetadata:function(e,t,a,n){if(this.formErrorMessage="",this.mappedCollection.mapping[a]&&this.mappedCollection.mapping[a]&&this.mappedCollection.mapping[a][n]){var o=Array.isArray(this.mappedCollection.mapping[a][n])?{}:this.mappedCollection.mapping[a][n],i="";for(var l in o)o[l]==t&&(i=l);""!=i&&delete o[i],e&&(o[e]=t),this.mappedCollection.mapping[a][n]=o,this.collectionMetadata.push(""),this.collectionMetadata.pop()}},onSelectCollectionMetadata:function(e,t,a,n){this.formErrorMessage="";var o="";for(var i in this.mappedCollection.mapping)this.mappedCollection.mapping[i]==t&&(o=i),a&&Object.keys(this.mappedCollection.mapping[i])&&Object.keys(this.mappedCollection.mapping[i])[0]&&Object.keys(this.mappedCollection.mapping[i])[0]==t&&(o=i);""!=o&&delete this.mappedCollection.mapping[o];var l="";a?(l={})[t]=n:l=t,this.mappedCollection.mapping[e]=l,this.collectionMetadata.push(""),this.collectionMetadata.pop()},onSelectMetadatumType:function(e){var t=this;this.formErrorMessage="",this.sendMetadatum({collectionId:this.collectionId,name:e.name,metadatumType:e.className,status:"auto-draft",isRepositoryLevel:!1,newIndex:0}).then((function(a){t.selectedMetadatumType=e.className,t.metadatum=a,t.isEditingMetadatum=!0})).catch((function(e){t.$console.error(e)}))},createNewMetadatum:function(){var e=this;this.fetchMetadatumTypes().then((function(){e.isLoadingMetadatumTypes=!1,e.isNewMetadatumModalActive=!0})).catch((function(){e.isLoadingMetadatumTypes=!1}))},onMetadatumEditionFinished:function(){var e=this;delete this.metadatum,this.isEditingMetadatum=!1,this.isNewMetadatumModalActive=!1,this.selectedMetadatumType=void 0,this.isFetchingCollectionMetadata=!0,null!=this.metadataSearchCancel&&this.metadataSearchCancel.cancel("Metadata search Canceled."),this.fetchMetadata({collectionId:this.collectionId,isRepositoryLevel:!1,isContextEdit:!1,parent:"any"}).then((function(t){t.request.then((function(t){e.collectionMetadata=JSON.parse(JSON.stringify(t)),e.isFetchingCollectionMetadata=!1})).catch((function(t){e.$console.error(t),e.isFetchingCollectionMetadata=!1})),e.metadataSearchCancel=t.source})).catch((function(){return e.isFetchingCollectionMetadata=!1}))},onMetadatumEditionCanceled:function(){this.metadatum&&delete this.metadatum,this.isEditingMetadatum=!1,this.isNewMetadatumModalActive=!1,this.selectedMetadatumType=void 0},onConfirmTitleSelection:function(e){e.preventDefault();var t=this.collectionMetadata.findIndex((function(e){return"Tainacan\\Metadata_Types\\Core_Title"==e.metadata_type}));t>=0&&this.onSelectCollectionMetadata(this.collectionMetadata[t].id,this.importerSourceInfo.source_metadata[this.selectedTitle]),this.showTitlePromptModal=!1,this.onRunImporter()},createAllMetadata:function(){var e=this;this.mappedCollection.mapping={},this.importerSourceInfo.source_metadata.forEach((function(t,a){e.mappedCollection.mapping["create_metadata"+a]=t}))}})}},33964:(e,t,a)=>{a.d(t,{X:()=>be});var n=a(6934);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var i=function(e){return(0,n.Qi)("data-v-6a8bdd48"),e=e(),(0,n.jt)(),e},l={class:"repository-level-page page-container"},r={class:"tainacan-page-title"},c=i((function(){return(0,n.Lk)("hr",null,null,-1)})),d={class:"breadcrumbs"},s={key:0,class:"tainacan-form","label-width":"120px"},u=i((function(){return(0,n.Lk)("br",null,null,-1)})),p={key:0},m={class:"mapping-control"},f=i((function(){return(0,n.Lk)("span",{class:"icon"},[(0,n.Lk)("i",{class:"tainacan-icon tainacan-icon-approvedcircle"})],-1)})),h=i((function(){return(0,n.Lk)("span",{class:"icon"},[(0,n.Lk)("i",{class:"tainacan-icon tainacan-icon-add"})],-1)})),g={key:0,class:"mapping-header"},b=i((function(){return(0,n.Lk)("hr",null,null,-1)})),v=i((function(){return(0,n.Lk)("span",{class:"icon"},[(0,n.Lk)("i",{class:"tainacan-icon tainacan-icon-pointer tainacan-icon-1-25em"})],-1)})),_=i((function(){return(0,n.Lk)("hr",null,null,-1)})),y={value:null},k=["value"],C=["value"],M=["value","disabled"],I={class:"metadatum-name"},L={class:"label-details"},x={value:null},S=["value"],E=["value","disabled"],w={class:"metadatum-name"},$={class:"label-details"},T={value:null},O=["value","disabled"],j={class:"metadatum-name"},X={class:"label-details"},F={key:2},A={style:{"font-style":"italic"}},N={key:2},P=i((function(){return(0,n.Lk)("br",null,null,-1)})),V={key:3},Q=i((function(){return(0,n.Lk)("br",null,null,-1)})),W={key:0,autofocus:"true",tabindex:"-1",role:"dialog","aria-modal":""},R={class:"tainacan-modal-content"},U={class:"tainacan-modal-title"},z=i((function(){return(0,n.Lk)("hr",null,null,-1)})),K={class:"tainacan-form"},D={class:"metadata-types-container"},J=["onClick"],B={class:"field is-grouped form-submit"},H={class:"control"},q={key:1},G={class:"field is-grouped form-submit"},Y={class:"control"},Z={class:"help is-danger"},ee={class:"control"},te=["disabled"],ae={class:"tainacan-modal-content tainacan-form"},ne={class:"tainacan-modal-title"},oe=i((function(){return(0,n.Lk)("hr",null,null,-1)})),ie={class:"columns"},le={class:"column"},re={style:{margin:"12px 0px 24px 0px"}},ce=["value"],de={class:"metadatum-name"},se={style:{"text-align":"right"},class:"column"},ue=i((function(){return(0,n.Lk)("div",null,null,-1)})),pe={style:{"margin-top":"-24px"},class:"field is-grouped form-submit"},me={class:"control"},fe={style:{"margin-left":"auto"},class:"control"},he={class:"control"},ge=["disabled"];function be(e,t,a,i,be,ve){var _e=(0,n.g2)("router-link"),ye=(0,n.g2)("b-loading"),ke=(0,n.g2)("b-select"),Ce=(0,n.g2)("metadatum-edition-form"),Me=(0,n.g2)("b-modal"),Ie=(0,n.g2)("b-field");return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("div",r,[(0,n.Lk)("h1",null,(0,n.v_)(e.$i18n.get("label_metadata_mapping")),1),(0,n.Lk)("a",{class:"back-link has-text-secondary",onClick:t[0]||(t[0]=function(t){return e.$router.go(-1)})},(0,n.v_)(e.$i18n.get("back")),1),c,(0,n.Lk)("nav",d,[(0,n.bF)(_e,{to:e.$routerHelper.getCollectionsPath()},{default:(0,n.k6)((function(){return[(0,n.eW)((0,n.v_)(e.$i18n.get("repository")),1)]})),_:1},8,["to"]),(0,n.eW)(" > "),(0,n.bF)(_e,{to:e.$routerHelper.getAvailableImportersPath()},{default:(0,n.k6)((function(){return[(0,n.eW)((0,n.v_)(e.$i18n.get("importers")),1)]})),_:1},8,["to"]),(0,n.eW)(" > "),(0,n.bF)(_e,{to:e.$routerHelper.getImporterPath(be.importerType,e.sessionId)},{default:(0,n.k6)((function(){return[(0,n.eW)((0,n.v_)(null!=be.importerType?null!=be.importerName?be.importerName:be.importerType:e.$i18n.get("title_importer_page")),1)]})),_:1},8,["to"]),(0,n.eW)(" > "),(0,n.bF)(_e,{to:e.$routerHelper.getImporterMappingPath(be.importerType,e.sessionId,be.collectionId)},{default:(0,n.k6)((function(){return[(0,n.eW)((0,n.v_)(e.$i18n.get("label_metadata_mapping")),1)]})),_:1},8,["to"])])]),(0,n.bF)(ye,{modelValue:be.isLoading,"onUpdate:modelValue":t[1]||(t[1]=function(e){return be.isLoading=e}),"can-cancel":!1},null,8,["modelValue"]),null!=be.importer&&null!=be.importer?((0,n.uX)(),(0,n.CE)("form",s,[(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("info_metadata_mapping_helper")),1),u,(0,n.bF)(ye,{modelValue:be.isLoadingSourceInfo,"onUpdate:modelValue":t[2]||(t[2]=function(e){return be.isLoadingSourceInfo=e}),"is-full-page":!1,"can-cancel":!1},null,8,["modelValue"]),null==be.importerSourceInfo||null==be.importerSourceInfo||be.isLoading?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",m,[be.importerSourceInfo.source_metadata&&be.importerSourceInfo.source_metadata.length>0?((0,n.uX)(),(0,n.CE)("a",{key:0,style:{"margin-left":"2rem","font-size":"0.875em"},class:"is-inline is-pulled-right add-link has-text-secondary",onClick:t[3]||(t[3]=function(e){return ve.createAllMetadata()})},[f,(0,n.eW)(" "+(0,n.v_)(e.$i18n.get("label_set_all_create_metadata")),1)])):(0,n.Q3)("",!0),null!=be.collectionId&&null!=be.collectionId&&be.importerSourceInfo.source_metadata&&be.importerSourceInfo.source_metadata.length>0&&be.collection&&be.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("a",{key:1,style:{"font-size":"0.875em"},class:"is-inline is-pulled-right add-link has-text-secondary",onClick:t[4]||(t[4]=function(e){return ve.createNewMetadatum()})},[h,(0,n.eW)(" "+(0,n.v_)(e.$i18n.get("label_add_more_metadata")),1)])):(0,n.Q3)("",!0)]),be.importerSourceInfo.source_metadata.length>0||be.importerSourceInfo.source_special_fields&&be.importerSourceInfo.source_special_fields.length>0?((0,n.uX)(),(0,n.CE)("div",g,[(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("label_from_source_collection")),1),b,v,_,(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("label_to_target_collection")),1)])):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(be.importerSourceInfo.source_metadata,(function(t,a){return(0,n.uX)(),(0,n.CE)("div",{key:a,class:(0,n.C4)(["source-metadatum",{"has-children":"object"==o(t)&&Object.entries(t)[0]}])},["string"==typeof t?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("p",null,(0,n.v_)(t),1),null!=be.collectionMetadata&&be.collectionMetadata.length>0&&!e.isFetchingCollectionMetadata?((0,n.uX)(),(0,n.Wv)(ke,{key:0,"model-value":ve.checkCurrentSelectedCollectionMetadatum(t),placeholder:e.$i18n.get("label_select_metadatum"),"onUpdate:modelValue":function(e){return ve.onSelectCollectionMetadata(e,t)}},{default:(0,n.k6)((function(){return[(0,n.Lk)("option",y,(0,n.v_)(e.$i18n.get("label_select_metadatum")),1),be.collection&&be.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("option",{key:0,value:"create_metadata"+a},(0,n.v_)(e.$i18n.get("label_create_metadatum")),9,k)):(0,n.Q3)("",!0),be.collection&&be.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("option",{key:1,value:"create_repository_metadata"+a},(0,n.v_)(e.$i18n.get("label_create_repository_metadata")),9,C)):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(ve.collectionNonChildMetadata,(function(a,o){return(0,n.uX)(),(0,n.CE)("option",{key:o,value:a.id,disabled:ve.checkIfMetadatumIsAvailable(a.id)||ve.checkIfMetadatumIsCompound(a)&&t.indexOf("compound|(")<0},[(0,n.Lk)("span",I,(0,n.v_)(a.name),1),(0,n.Lk)("span",L,[(0,n.eW)(" ("+(0,n.v_)(a.metadata_type_object.name)+") ",1),(0,n.Lk)("em",null,(0,n.v_)(a.collection_id!=be.collectionId?e.$i18n.get("label_inherited"):""),1)])],8,M)})),128))]})),_:2},1032,["model-value","placeholder","onUpdate:modelValue"])):(0,n.Q3)("",!0)],64)):"object"==o(t)&&Object.entries(t)[0]?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.Lk)("p",null,(0,n.v_)(Object.entries(t)[0][0]),1),null!=be.collectionMetadata&&be.collectionMetadata.length>0&&!e.isFetchingCollectionMetadata?((0,n.uX)(),(0,n.Wv)(ke,{key:0,"model-value":ve.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0),placeholder:e.$i18n.get("label_select_metadatum"),"onUpdate:modelValue":function(e){return ve.onSelectCollectionMetadata(e,Object.entries(t)[0][0],!0,Object.entries(t)[0][1])}},{default:(0,n.k6)((function(){return[(0,n.Lk)("option",x,(0,n.v_)(e.$i18n.get("label_select_metadatum")),1),be.collection&&be.collection.current_user_can_edit_metadata?((0,n.uX)(),(0,n.CE)("option",{key:0,value:"create_metadata"+a},(0,n.v_)(e.$i18n.get("label_create_metadatum")),9,S)):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(ve.collectionNonChildMetadata,(function(a,i){return(0,n.uX)(),(0,n.CE)("option",{key:i,value:a.id,disabled:!ve.checkIfMetadatumIsCompound(a)||ve.checkIfMetadatumIsAvailable(a.id)||"object"!=o(t)||!Object.entries(t)[0]},[(0,n.Lk)("span",w,(0,n.v_)(a.name),1),(0,n.Lk)("span",$,[(0,n.eW)(" ("+(0,n.v_)(a.metadata_type_object.name)+") ",1),(0,n.Lk)("em",null,(0,n.v_)(a.collection_id!=be.collectionId?e.$i18n.get("label_inherited"):""),1)])],8,E)})),128))]})),_:2},1032,["model-value","placeholder","onUpdate:modelValue"])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,n.C4)([{"disabled-child-source-metadatum":[void 0,null,!1,"create_metadata"+a].includes(ve.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0))},"child-source-metadatum"])},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Object.entries(t)[0][1],(function(o,i){return(0,n.uX)(),(0,n.CE)("div",{key:i,class:"source-metadatum"},[(0,n.Lk)("p",null,(0,n.v_)(o),1),null!=be.collectionMetadata&&be.collectionMetadata.length>0&&!e.isFetchingCollectionMetadata?((0,n.uX)(),(0,n.Wv)(ke,{key:0,disabled:[void 0,null,!1,"create_metadata"+a].includes(ve.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0)),"model-value":ve.checkCurrentSelectedCollectionChildMetadatum(o,ve.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0)),placeholder:e.$i18n.get("label_select_metadatum"),"onUpdate:modelValue":function(e){return ve.onSelectCollectionChildMetadata(e,o,ve.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0),Object.entries(t)[0][0])}},{default:(0,n.k6)((function(){return[(0,n.Lk)("option",T,(0,n.v_)(e.$i18n.get("label_select_metadatum")),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(ve.getChildOfSelectedCompoundMetadata(t),(function(a,o){return(0,n.uX)(),(0,n.CE)("option",{key:o,value:a.id,disabled:ve.checkIfChildMetadatumIsAvailable(a.id,ve.checkCurrentSelectedCollectionMetadatum(Object.entries(t)[0][0],!0),Object.entries(t)[0][0])},[(0,n.Lk)("span",j,(0,n.v_)(a.name),1),(0,n.Lk)("span",X,[(0,n.eW)(" ("+(0,n.v_)(a.metadata_type_object.name)+") ",1),(0,n.Lk)("em",null,(0,n.v_)(a.collection_id!=be.collectionId?e.$i18n.get("label_inherited"):""),1)])],8,O)})),128))]})),_:2},1032,["disabled","model-value","placeholder","onUpdate:modelValue"])):(0,n.Q3)("",!0)])})),128))],2)],64)):(0,n.Q3)("",!0),null==be.collectionMetadata||be.collectionMetadata.length<=0?((0,n.uX)(),(0,n.CE)("p",F,(0,n.v_)(e.$i18n.get("info_select_collection_to_list_metadata")),1)):(0,n.Q3)("",!0)],2)})),128)),be.importerSourceInfo.source_special_fields?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(be.importerSourceInfo.source_special_fields,(function(t,a){return(0,n.uX)(),(0,n.CE)("div",{key:a,class:"source-metadatum"},[(0,n.Lk)("p",A,(0,n.v_)(t),1),(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("info_special_fields_mapped_default")),1)])})),128)):(0,n.Q3)("",!0),be.importerSourceInfo.source_metadata.length<=0?((0,n.uX)(),(0,n.CE)("p",N,[(0,n.eW)((0,n.v_)(e.$i18n.get("info_no_metadata_source_file")),1),P])):(0,n.Q3)("",!0),!be.importerSourceInfo.source_special_fields||be.importerSourceInfo.source_special_fields.length<=0?((0,n.uX)(),(0,n.CE)("p",V,[(0,n.eW)((0,n.v_)(e.$i18n.get("info_no_special_fields_available")),1),Q])):(0,n.Q3)("",!0),(0,n.bF)(Me,{modelValue:be.isNewMetadatumModalActive,"onUpdate:modelValue":t[9]||(t[9]=function(e){return be.isNewMetadatumModalActive=e}),"trap-focus":"","aria-modal":"","aria-role":"dialog","close-button-aria-label":e.$i18n.get("close"),"custom-class":"tainacan-modal",onClose:t[10]||(t[10]=function(e){return ve.onMetadatumEditionCanceled()})},{default:(0,n.k6)((function(){return[null!=be.selectedMetadatumType||be.isEditingMetadatum?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",W,[(0,n.bF)(ye,{modelValue:be.isLoadingMetadatumTypes,"onUpdate:modelValue":t[5]||(t[5]=function(e){return be.isLoadingMetadatumTypes=e}),"is-full-page":!1},null,8,["modelValue"]),(0,n.Lk)("div",R,[(0,n.Lk)("div",U,[(0,n.Lk)("h2",null,(0,n.v_)(e.$i18n.get("instruction_select_metadatum_type")),1),z]),(0,n.Lk)("section",K,[(0,n.Lk)("div",D,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.metadatumTypes,(function(e,t){return(0,n.uX)(),(0,n.CE)("div",{key:t,class:"metadata-type",onClick:function(t){return ve.onSelectMetadatumType(e)}},[(0,n.Lk)("h4",null,(0,n.v_)(e.name),1)],8,J)})),128))]),(0,n.Lk)("div",B,[(0,n.Lk)("div",H,[(0,n.Lk)("button",{id:"button-cancel-importer-edition",class:"button is-outlined",type:"button",onClick:t[6]||(t[6]=function(e){ve.onMetadatumEditionCanceled(),be.isNewMetadatumModalActive=!1})},(0,n.v_)(e.$i18n.get("cancel")),1)])])])])])),be.selectedMetadatumType&&be.isEditingMetadatum?((0,n.uX)(),(0,n.Wv)(Ce,{key:1,"collection-id":be.collectionId,"is-repository-level":!1,index:0,"original-metadatum":be.metadatum,"is-inside-importer-flow":!0,onOnEditionFinished:t[7]||(t[7]=function(e){return ve.onMetadatumEditionFinished()}),onOnEditionCanceled:t[8]||(t[8]=function(e){return ve.onMetadatumEditionCanceled()})},null,8,["collection-id","original-metadatum"])):(0,n.Q3)("",!0)]})),_:1},8,["modelValue","close-button-aria-label"])])),null==be.importerSourceInfo||null==be.importerSourceInfo?((0,n.uX)(),(0,n.CE)("div",q,[(0,n.Lk)("p",null,(0,n.v_)(e.$i18n.get("info_upload_a_source_to_see_metadata")),1)])):(0,n.Q3)("",!0),(0,n.Lk)("div",G,[(0,n.Lk)("div",Y,[(0,n.Lk)("button",{id:"button-cancel-importer-mapping",class:"button is-outlined",type:"button",onClick:t[11]||(t[11]=function(){return ve.cancelBack&&ve.cancelBack.apply(ve,arguments)})},(0,n.v_)(e.$i18n.get("cancel")),1)]),(0,n.Lk)("p",Z,(0,n.v_)(be.formErrorMessage),1),(0,n.Lk)("div",ee,[(0,n.Lk)("button",{id:"button-submit-importer-mapping",disabled:null==e.sessionId||null==be.importer,class:(0,n.C4)([{"is-loading":be.isLoadingRun,"is-success":!be.isLoadingRun},"button"]),onClick:t[12]||(t[12]=(0,n.D$)((function(){return ve.onRunImporter&&ve.onRunImporter.apply(ve,arguments)}),["prevent"]))},(0,n.v_)(e.$i18n.get("run")),11,te)])])])):(0,n.Q3)("",!0),be.importerSourceInfo?((0,n.uX)(),(0,n.Wv)(Me,{key:1,modelValue:be.showTitlePromptModal,"onUpdate:modelValue":t[17]||(t[17]=function(e){return be.showTitlePromptModal=e}),"can-cancel":!1,width:820,scroll:"keep","trap-focus":"","close-button-aria-label":e.$i18n.get("close"),autofocus:"",role:"dialog",tabindex:"-1","aria-modal":"","custom-class":"tainacan-modal"},{default:(0,n.k6)((function(){return[(0,n.Lk)("form",ae,[(0,n.Lk)("div",ne,[(0,n.Lk)("h2",null,(0,n.v_)(e.$i18n.get("instruction_select_title_mapping")),1),oe]),(0,n.Lk)("div",ie,[(0,n.Lk)("div",le,[(0,n.Lk)("p",re,(0,n.v_)(e.$i18n.get("info_title_mapping")),1),(0,n.bF)(Ie,null,{default:(0,n.k6)((function(){return[(0,n.bF)(ke,{modelValue:be.selectedTitle,"onUpdate:modelValue":t[13]||(t[13]=function(e){return be.selectedTitle=e}),expanded:"",placeholder:e.$i18n.get("label_select_metadatum")},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(be.importerSourceInfo.source_metadata,(function(e,t){return(0,n.uX)(),(0,n.CE)("option",{key:t,value:t},[(0,n.Lk)("span",de,(0,n.v_)(e),1)],8,ce)})),128))]})),_:1},8,["modelValue","placeholder"])]})),_:1})]),(0,n.Lk)("div",se,[((0,n.uX)(),(0,n.CE)(n.FK,null,(0,n.pI)(4,(function(t){return(0,n.Lk)("div",{key:t,class:"item-demo"},[(0,n.Lk)("p",null,(0,n.v_)(""==be.selectedTitle||null==be.selectedTitle?e.$i18n.get("label_title"):be.importerSourceInfo.source_metadata[be.selectedTitle]),1),ue])})),64))])]),(0,n.Lk)("div",pe,[(0,n.Lk)("div",me,[(0,n.Lk)("button",{class:"button is-outlined",type:"button",onClick:t[14]||(t[14]=function(e){be.selectedTitle="",be.showTitlePromptModal=!1})},(0,n.v_)(e.$i18n.get("cancel")),1)]),(0,n.Lk)("div",fe,[(0,n.Lk)("button",{class:"button is-secondary",type:"button",onClick:t[15]||(t[15]=function(e){be.selectedTitle="",be.showTitlePromptModal=!1,ve.onRunImporter(!0)})},(0,n.v_)(e.$i18n.get("skip")),1)]),(0,n.Lk)("div",he,[(0,n.Lk)("button",{type:"submit",class:"button is-success",disabled:""===be.selectedTitle||null==be.selectedTitle,onClick:t[16]||(t[16]=function(){return ve.onConfirmTitleSelection&&ve.onConfirmTitleSelection.apply(ve,arguments)})},(0,n.v_)(e.$i18n.get("apply")),9,ge)])])])]})),_:1},8,["modelValue","close-button-aria-label"])):(0,n.Q3)("",!0)])}},66019:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(31601),o=a.n(n),i=a(76314),l=a.n(i)()(o());l.push([e.id,".tainacan-page-title[data-v-6a8bdd48]{margin-bottom:38px}.tainacan-page-title h1[data-v-6a8bdd48],.tainacan-page-title h2[data-v-6a8bdd48]{font-size:1.25em;font-weight:500;color:var(--tainacan-blue5);display:inline-block}.tainacan-page-title a.back-link[data-v-6a8bdd48]{font-weight:500;float:right;margin-top:5px}.tainacan-page-title hr[data-v-6a8bdd48]{margin:3px 0px 4px 0px;height:1px;background-color:var(--tainacan-secondary)}.tainacan-page-title .breadcrumbs[data-v-6a8bdd48]{font-size:0.75em}.tainacan-page-title .level-left .level-item[data-v-6a8bdd48]{display:inline-block;margin-left:268px}@media screen and (max-width: 769px){.tainacan-page-title[data-v-6a8bdd48]{top:206px;margin-bottom:0px !important}.tainacan-page-title .level-left[data-v-6a8bdd48]{margin-left:0px !important}.tainacan-page-title .level-left .level-item[data-v-6a8bdd48]{margin-left:30px}.tainacan-page-title .level-right[data-v-6a8bdd48]{display:none}}.page-container[data-v-6a8bdd48]{padding-bottom:0}.field[data-v-6a8bdd48]{position:relative}.tainacan-form[data-v-6a8bdd48]{display:flex;flex-direction:column;justify-content:space-between;min-height:247px}.form-submit[data-v-6a8bdd48]{margin-top:24px;position:sticky !important;bottom:0;background:var(--tainacan-background-color, white);z-index:9;padding:12px;border-top:1px solid var(--tainacan-gray3);box-shadow:0 -5px 12px -14px var(--tainacan-gray5)}.section-label[data-v-6a8bdd48]{font-size:1em !important;font-weight:500 !important;color:var(--tainacan-blue5) !important;line-height:1.2em}.source-metadatum[data-v-6a8bdd48]{padding:2px 0;min-height:35px;width:calc(100% - 32px);margin:3px 16px 6px 16px;display:flex;justify-content:space-between;align-items:center;position:relative}.source-metadatum[data-v-6a8bdd48]::before{display:block;content:'';position:absolute;height:1px;width:100%;background-color:var(--tainacan-gray2);z-index:-1}.source-metadatum>p[data-v-6a8bdd48]{font-weight:normal;transition:font-weight 0.1s ease;padding-right:6px;overflow:hidden;word-wrap:break-word;background-color:var(--tainacan-background-color, white)}.source-metadatum .control[data-v-6a8bdd48]{max-width:60%}.source-metadatum:hover>.control[data-v-6a8bdd48]{--tainacan-input-border-color: var(--tainacan-gray4)}.source-metadatum[data-v-6a8bdd48]:hover::before{background-color:var(--tainacan-gray4)}.source-metadatum:hover>p[data-v-6a8bdd48]{font-weight:bold}.source-metadatum.has-children[data-v-6a8bdd48]{flex-wrap:wrap}.source-metadatum.has-children[data-v-6a8bdd48]::before{top:1rem}.child-source-metadatum[data-v-6a8bdd48]{flex-basis:100%;border-left:1px solid var(--tainacan-gray2);padding-left:1em;opacity:1;transition:border-left 0.2s ease, opacity 0.2s ease}.child-source-metadatum .source-metadatum[data-v-6a8bdd48]{border-bottom:none;margin-bottom:0;margin-top:2px;padding-top:8px;padding-bottom:0px}.child-source-metadatum.disabled-child-source-metadatum[data-v-6a8bdd48]{border-left:1px solid var(--tainacan-gray1);opacity:0.70}.is-inline .control[data-v-6a8bdd48]{display:inline}.drop-inner[data-v-6a8bdd48]{padding:1em 3em}.mapping-control[data-v-6a8bdd48]{background-color:var(--tainacan-background-color, white);position:sticky;top:-34px;z-index:9;height:2.5rem;padding-top:12px}.mapping-header[data-v-6a8bdd48]{background-color:var(--tainacan-background-color, white);position:sticky;top:0;z-index:9;width:100%;display:flex;justify-content:space-between;align-items:center;color:var(--tainacan-info-color);font-size:0.875em;font-weight:bold;margin:0 0 12px 0;border-bottom:1px solid var(--tainacan-gray3);box-shadow:0 5px 12px -14px var(--tainacan-gray5)}.mapping-header p[data-v-6a8bdd48]{white-space:nowrap}.mapping-header hr[data-v-6a8bdd48]{width:100%;margin-left:12px;margin-right:12px;height:1px;background:linear-gradient(90deg, #f2f2f2, #dbdbdb, #f2f2f2)}@media screen and (max-width: 768px){.mapping-header p[data-v-6a8bdd48]{white-space:normal}.mapping-header hr[data-v-6a8bdd48]{display:none}}.tainacan-modal .animation-content[data-v-6a8bdd48]{width:100%;z-index:99999}.tainacan-modal .animation-content #metadatumEditForm[data-v-6a8bdd48]{background-color:var(--tainacan-background-color)}.metadata-types-container .metadata-type[data-v-6a8bdd48]{border-bottom:1px solid var(--tainacan-gray2);padding:15px calc(2 * var(--tainacan-one-column));cursor:pointer}.metadata-types-container .metadata-type[data-v-6a8bdd48]:first-child{margin-top:15px}.metadata-types-container .metadata-type[data-v-6a8bdd48]:last-child{border-bottom:none}.metadata-types-container .metadata-type[data-v-6a8bdd48]:hover{background-color:var(--tainacan-gray1)}.item-demo[data-v-6a8bdd48]{display:inline-block;margin:8px 12px}.item-demo p[data-v-6a8bdd48]{max-width:74px;font-size:0.875em;color:var(--tainacan-gray5);margin:4px 8px;text-align:left;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.item-demo div[data-v-6a8bdd48]{height:90px;width:90px;background-color:var(--tainacan-gray2);border-radius:2px}\n",""]);const r=l},12606:(e,t,a)=>{var n=a(85072),o=a.n(n),i=a(97825),l=a.n(i),r=a(77659),c=a.n(r),d=a(55056),s=a.n(d),u=a(10540),p=a.n(u),m=a(63494),f=a.n(m),h=a(66019),g={};g.styleTagTransform=f(),g.setAttributes=s(),g.insert=c().bind(null,"head"),g.domAPI=l(),g.insertStyleElement=p();o()(h.A,g),h.A&&h.A.locals&&h.A.locals},29560:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(86035),o=a(40043);a(94975);const i=(0,a(66262).A)(o.A,[["render",n.X],["__scopeId","data-v-6a8bdd48"]])},40043:(e,t,a)=>{a.d(t,{A:()=>n.A});var n=a(15500)},86035:(e,t,a)=>{a.d(t,{X:()=>n.X});var n=a(33964)},94975:(e,t,a)=>{a(12606)}}]);