"use strict";(self.webpackChunktainacan=self.webpackChunktainacan||[]).push([[1070],{92920:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(75552),o=a(8926),n=a(91301);const l={components:{CheckboxRadioFilterInput:n.A},mixins:[o.s,o.F],props:{filtersAsModal:Boolean},emits:["input","update-parent-collapse"],data:function(){return{options:[],selected:[]}},watch:{selected:{handler:function(e,t){Array.isArray(e)&&Array.isArray(t)&&e.length==t.length&&e.every((function(e,a){return e===t[a]}))||this.onSelect()},deep:!0},facetsFromItemSearch:{handler:function(){this.isUsingElasticSearch&&this.loadOptions()},immediate:!0,deep:!0}},mounted:function(){this.isUsingElasticSearch||this.loadOptions()},created:function(){this.$eventBusSearchEmitter.on("hasToReloadFacets",this.reloadOptions)},beforeUnmount:function(){this.$eventBusSearchEmitter.off("hasToReloadFacets",this.reloadOptions)},methods:{reloadOptions:function(e){!this.isUsingElasticSearch&&e&&this.loadOptions()},loadOptions:function(){var e=this,t=null;null!=this.getOptionsValuesCancel&&this.getOptionsValuesCancel.cancel("Facet search Canceled."),(t="Tainacan\\Metadata_Types\\Relationship"===this.metadatumType||"Tainacan\\Metadata_Types\\Control"===this.metadatumType?this.getValuesRelationship({search:null,isRepositoryLevel:this.isRepositoryLevel,valuesToIgnore:[],offset:0,number:this.filter.max_options,isInCheckboxModal:!1,getSelected:"1"}):this.getValuesPlainText({metadatumId:this.metadatumId,search:null,isRepositoryLevel:this.isRepositoryLevel,valuesToIgnore:[],offset:0,number:this.filter.max_options,isInCheckboxModal:!1,getSelected:"1"})).request.then((function(t){e.updateSelectedValues(),t&&t.data&&t.data.values&&e.$emit("update-parent-collapse",t.data.values.length>0)})).catch((function(t){(0,i.FZ)(t)?(e.$console.log("Request canceled: "+t.message),e.updateSelectedValues()):e.$console.error(t)})),this.getOptionsValuesCancel=t.source},onSelect:function(){this.$emit("input",{filter:"checkbox",compare:"IN",metadatum_id:this.metadatumId,collection_id:this.collectionId,value:this.selected})},updateSelectedValues:function(){var e=this;if(!this.query||!this.query.metaquery||!Array.isArray(this.query.metaquery))return!1;var t=this.query.metaquery.findIndex((function(t){return t.key==e.metadatumId}));this.selected=t>=0?this.query.metaquery.slice()[t].value:[]},openCheckboxModal:function(){var e=this;this.$buefy.modal.open({parent:this,component:n.A,props:{filter:this.filter,selected:this.selected,metadatumId:this.metadatumId,collectionId:this.collectionId,metadatumType:this.metadatumType,isRepositoryLevel:this.isRepositoryLevel,query:this.query},events:{appliedCheckBoxModal:function(){e.loadOptions()},input:function(t){var a=e.selected.indexOf(t);a>=0?e.selected.splice(a,1):e.selected.push(t)}},trapFocus:!0,customClass:"tainacan-modal",closeButtonAriaLabel:this.$i18n.get("close")})}}}},74708:(e,t,a)=>{a.d(t,{X:()=>p});var i=a(6934),o={key:0,class:"b-checkbox checkbox is-small"},n=["value"],l=function(e){return(0,i.Qi)("data-v-2b37cd84"),e=e(),(0,i.jt)(),e}((function(){return(0,i.Lk)("span",{class:"check"},null,-1)})),s={class:"control-label"},c={class:"checkbox-label-text"},r={key:0,class:"facet-item-count has-text-gray"},d=["onClick"],u={key:0,class:"no-options-placeholder"};function p(e,t,a,p,h,m){var f=(0,i.g2)("checkbox-radio-filter-input"),v=(0,i.gN)("tooltip");return(0,i.uX)(),(0,i.CE)("div",{style:(0,i.Tr)({height:e.isLoadingOptions&&!a.filtersAsModal?1.375*Number(e.filter.max_options)+"rem":"auto"}),class:(0,i.C4)([{skeleton:e.isLoadingOptions&&!a.filtersAsModal},"block"])},[a.filtersAsModal?((0,i.uX)(),(0,i.Wv)(f,{key:1,"is-modal":!1,filter:e.filter,selected:h.selected,"metadatum-id":e.metadatumId,"collection-id":e.collectionId,"metadatum-type":e.metadatumType,"is-repository-level":e.isRepositoryLevel,query:e.query,"current-collection-id":e.currentCollectionId,onInput:t[2]||(t[2]=function(e){var t=h.selected.indexOf(e);t>=0?h.selected.splice(t,1):h.selected.push(e)})},null,8,["filter","selected","metadatum-id","collection-id","metadatum-type","is-repository-level","query","current-collection-id"])):((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[e.isLoadingOptions?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(h.options.slice(0,e.filter.max_options),(function(a,u){return(0,i.uX)(),(0,i.CE)("div",{key:u,class:"metadatum"},[u<=e.filter.max_options-1?((0,i.uX)(),(0,i.CE)("label",o,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return h.selected=e}),value:a.value,type:"checkbox",onInput:t[1]||(t[1]=function(t){return e.resetPage()})},null,40,n),[[i.lH,h.selected]]),l,(0,i.Lk)("span",s,[(0,i.bo)(((0,i.uX)(),(0,i.CE)("span",c,[(0,i.eW)((0,i.v_)(a.label),1)])),[[v,{delay:{show:800,hide:100},content:a.label,autoHide:!0,popperClass:["tainacan-tooltip","tooltip",e.isRepositoryLevel?"tainacan-repository-tooltip":""],placement:"auto-start"}]]),null!=a.total_items?((0,i.uX)(),(0,i.CE)("span",r,"Â "+(0,i.v_)("("+a.total_items+")"),1)):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0),a.showViewAllButton&&u==h.options.slice(0,e.filter.max_options).length-1?((0,i.uX)(),(0,i.CE)("button",{key:1,class:"view-all-button link-style",onClick:function(e){return m.openCheckboxModal(a.parent)}},(0,i.v_)(e.$i18n.get("label_view_all")),9,d)):(0,i.Q3)("",!0)])})),128)),null!=h.options.length&&h.options.length<=0?((0,i.uX)(),(0,i.CE)("p",u,(0,i.v_)(e.$i18n.get("info_no_options_available_filtering")),1)):(0,i.Q3)("",!0)],64))],64))],6)}},78163:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(31601),o=a.n(i),n=a(76314),l=a.n(n)()(o());l.push([e.id,".view-all-button[data-v-2b37cd84]{font-size:0.75em !important;padding:0.1em 1em}.is-loading[data-v-2b37cd84]:after{border:2px solid var(--tainacan-background-color) !important;border-top-color:var(--tainacan-gray2) !important;border-right-color:var(--tainacan-gray2) !important}.no-options-placeholder[data-v-2b37cd84]{margin-left:0.5em;font-size:0.75em;color:var(--tainacan-info-color)}.b-checkbox .control-label[data-v-2b37cd84]{display:flex;flex-wrap:nowrap;width:100%;align-items:center}.checkbox-label-text[data-v-2b37cd84]{white-space:wrap;text-overflow:ellipsis;overflow:hidden;line-height:1.45em;break-inside:avoid;display:-webkit-box;line-clamp:2;-webkit-line-clamp:2;-webkit-box-orient:vertical}.facet-item-count[data-v-2b37cd84]{margin-left:auto}.b-checkbox:hover .facet-item-count[data-v-2b37cd84],.b-checkbox:focus .facet-item-count[data-v-2b37cd84]{--tainacan-info-color: var(--tainacan-input-color)}\n",""]);const s=l},81272:(e,t,a)=>{var i=a(85072),o=a.n(i),n=a(97825),l=a.n(n),s=a(77659),c=a.n(s),r=a(55056),d=a.n(r),u=a(10540),p=a.n(u),h=a(63494),m=a.n(h),f=a(78163),v={};v.styleTagTransform=m(),v.setAttributes=d(),v.insert=c().bind(null,"head"),v.domAPI=l(),v.insertStyleElement=p();o()(f.A,v),f.A&&f.A.locals&&f.A.locals},71070:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var i=a(70941),o=a(13893);a(96060);const n=(0,a(66262).A)(o.A,[["render",i.X],["__scopeId","data-v-2b37cd84"]])},13893:(e,t,a)=>{a.d(t,{A:()=>i.A});var i=a(92920)},70941:(e,t,a)=>{a.d(t,{X:()=>i.X});var i=a(74708)},96060:(e,t,a)=>{a(81272)}}]);